/*
This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version
2 of the License, or (at your option) any later version.

A non-transferrable, royalty free license to this code
is granted to distributed.net for use exclusively in the DES Challenge II.

Copyright Biel/Switzerland, 15. Janaury 1999 by Christoph Dworzak

The s-boxes are based on the work of Matthew Kwan.

Version 2 (6.4MKey/s on PC164@500MHz)
*/

unsigned long PT[64], CT[64];

unsigned long checkKey(unsigned long *K, unsigned long init){
	static unsigned long t[128];
    unsigned long *u, *v, *w, r;

static inline void s1 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;
    unsigned long x17, x18, x19, x20;

    a1 ^= u[24];
    a2 ^= u[15];
    a3 ^= u[ 5];
    a4 ^= u[16];
    a5 ^= u[20];
    a6 ^= u[28];
    x01 = a3 & ~a5;
    x03 = a3 & ~a4;
    x02 = x01 ^ a4;
    x04 = x03 | a5;
    x05 = a6 & x04;
    x06 = x02 ^ x05;
    x07 = a4 & ~a5;
    x08 = a3 ^ a4;
    x09 = a6 & ~x08;
    x10 = (a5 ^ x05) & x08;
    x11 = ((x03 ^ x10) | a6) ^ (a5 & ~a4);
    w[ 0] = v[ 0] ^ ((((a2 | x11) ^ x10) & a1) ^ ((x07 ^ x09) | a2) ^ ~x06);
    x12 = (x01 | x05) ^ x08;
    x13 = x11 & ~x02;
    x14 = x06 | x07;
    x15 = (x09 ^ ~x12) & x11;
    x16 = (a2 & x15) ^ x14 ^ x13;
    w[ 1] = v[ 1] ^ ((a2 & ~x13) ^ (a1 & x16) ^ x12);
    x17 = a3 & x14;
    x18 = x11 & ~x17;
    x19 = (a2 | x03) ^ x18;
    x20 = (x12 & ~x18) | x03;
    w[ 2] = v[ 2] ^ ((((a3 | x15) ^ (a2 | ~x20)) & a1) ^ ~x19);
    w[ 3] = v[ 3] ^ ((((((x20 | x11) ^ ~a5) & a2) ^ ((x04 ^ x17) & ~x05)) | a1) ^ (x16 & ~x09) ^ ~x19);
}


static inline void s2 (
    unsigned long a1, unsigned long	a2,
    unsigned long a3, unsigned long	a4,
    unsigned long a5, unsigned long	a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;
    unsigned long x17, x18, x19, x20;

    a1 ^= u[20];
    a2 ^= u[28];
    a3 ^= u[ 8];
    a4 ^= u[27];
    a5 ^= u[19];
    a6 ^= u[ 2];
    x01 = a1 ^ a6;
    x02 = x01 ^ a5;
    x03 = a6 & a5;
    x04 = a1 & ~x03;
    x05 = a2 & ~x04;
    x06 = x02 ^ x05;
    x07 = (x03 | x05) & ~x01;
    x08 = (a3 | x07) ^ x06;
    x09 = a5 & ~x04;
    x10 = x09 | a2;
    x11 = (a4 & x10) ^ ~x08;
    w[ 4] = v[ 4] ^ (x11);
    x12 = a6 & ~x04;
    x13 = (x06 ^ x09) & a2;
    x14 = a5 ^ a2;
    x15 = x14 & ~x07;
    x16 = (x06 | a1) ^ a2;
    x17 = (a3 & ~x16) ^ x15;
    w[ 5] = v[ 5] ^ (((x12 ^ x13) & a3) ^ ((x04 ^ x11) & ~a2) ^ (a4 | x17) ^ x02);
    x18 = (x12 | x15) ^ x08;
    x19 = x16 | x13;
    w[ 6] = v[ 6] ^ (((x10 & ~(x14 & x19)) | a4) ^ (a3 & x19) ^ ~x18);
    x20 = a2 ^ x02;
    w[ 7] = v[ 7] ^ ((((x03 | x13) ^ ~(a3 & x03)) & a4) ^ (((x20 & ~x18) ^ ~x17) & a3) ^ ~x20);
}

static inline void s3 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;
    unsigned long x17;

    a1 ^= u[19];
    a2 ^= u[ 2];
    a3 ^= u[14];
    a4 ^= u[22];
    a5 ^= u[25];
    a6 ^= u[ 4];
    x01 = a2 ^ a3 ^ a6;
    x02 = a2 & x01;
    x03 = a5 | x02;
    x04 = x01 ^ x03;
    x05 = a3 ^ x02;
    x06 = x05 & ~a5;
    x07 = a6 & ~x02;
    x08 = x07 ^ a5;
    x09 = (((a1 & x08) ^ a5) | a4) ^ (a1 | x06) ^ x04;
    w[ 8] = v[ 8] ^ (x09);
    x10 = a3 & a6;
    x11 = x10 | x02;
    x12 = x11 ^ a5;
    x13 = x01 & ~x06;
    x14 = a2 | x06;
    x15 = (x08 | x13) ^ x11;
    w[ 9] = v[ 9] ^ ((((a1 | x15) ^ x14 ^ ~x03) & a4) ^ ((x13 ^ x10) | a1) ^ ~x12);
    x16 = ((((a6 ^ x11) & ~x04 & a1) ^ (x07 | x15)) & a4) ^ ((x06 & ~a3) | a1) ^ (a3 & a5) ^ x01;
    w[10] = v[10] ^ (x16);
    x17 = ((a6 & x09) ^ x05) & ~a1;
    w[11] = v[11] ^ (((((x16 & ~x14) | a1) ^ x17) & a4) ^ (a2 | x13) ^ x12 ^ ~x17);
}

static inline void s4 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;

    a1 ^= u[25];
    a2 ^= u[ 4];
    a3 ^= u[17];
    a4 ^= u[29];
    a5 ^= u[10];
    a6 ^= u[ 0];
    x01 = (a1 | a3) & a5;
    x02 = a1 ^ x01;
    x03 = (a3 & ~a1) | x02;
    x04 = a2 & x03;
    x05 = a5 ^ x04;
    x06 = (a2 | a3) ^ (a4 & x05) ^ x02;
    x07 = a3 ^ x01;
    x08 = x07 | x02;
    x09 = (a3 ^ a5) & ~a2;
    x10 = ((x08 ^ x09) | a4) ^ (a2 & ~x07) ^ x03;
    x11 = (a6 | x10) ^ x06;
    w[12] = v[12] ^ (x11);
    x12 = a6 & x10;
    w[13] = v[13] ^ (x12 ^ ~x06);
    x13 = ((a3 ^ x04 ^ ~x09) & a4) ^ (a2 & x05) ^ x08;
    x14 = x06 ^ x13;
    x15 = (a2 & ~x14) ^ (x14 & ~a4) ^ x11;
    x16 = (a6 | x15) ^ ~x13;
    w[14] = v[14] ^ (x16);
    w[15] = v[15] ^ (x12 ^ x15 ^ x16);
}

static inline void s5 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;
    unsigned long x17, x18, x19, x20, x21, x22;

    a1 ^= u[10];
    a2 ^= u[ 0];
    a3 ^= u[ 6];
    a4 ^= u[21];
    a5 ^= u[13];
    a6 ^= u[31];
    x01 = a3 & ~a4;
    x02 = x01 ^ a1;
    x03 = a1 & ~a3;
    x04 = a6 | x03;
    x05 = x02 ^ x04;
    x06 = a4 ^ a1;
    x07 = x06 | x01;
    x08 = x07 & ~a6;
    x09 = a3 ^ x08;
    x10 = (a3 & x07) ^ a4;
    x11 = (a4 ^ x03) | a6;
    x12 = (x10 & ~x03) ^ x11;
    x13 = (a5 | x12) ^ x10;
    x14 = (a5 | x09) ^ (x13 & ~a2) ^ x05;
    w[16] = v[16] ^ (x14);
    x15 = a1 ^ x09;
    x16 = (a5 & ~(x02 & x15)) ^ (a4 & x04) ^ x12;
    x17 = a4 | x15;
    w[17] = v[17] ^ ((x17 & ~a2) ^ x16);
    x18 = x12 & x05;
    x19 = x07 & ~x18;
    x20 = (x08 & ~a4) ^ a3;
    x21 = x09 ^ x18;
    w[18] = v[18] ^ ((((x10 | x11) ^ (a5 | x21)) | a2) ^ (a5 & x20) ^ ~x19);
    x22 = x13 & ~x19;
    w[19] = v[19] ^ (((((x14 ^ ~x21) & a5 & x17) ^ (x06 & x21) ^ x20) | a2) ^ (((x16 | x22) ^ ~x06) & a5) ^ x22 ^ x15);
}

static inline void s6 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;
    unsigned long x17;

    a1 ^= u[13];
    a2 ^= u[31];
    a3 ^= u[26];
    a4 ^= u[ 3];
    a5 ^= u[11];
    a6 ^= u[18];
    x01 = a5 ^ a1;
    x02 = x01 ^ a6;
    x03 = a1 & a6;
    x04 = x03 & ~a5;
    x05 = a4 & ~x04;
    x06 = x02 ^ x05;
    x07 = a6 ^ x03;
    x08 = ((x04 | x07) & ~a4) ^ x07;
    x09 = x04 | x08;
    x10 = ((((a6 | x06) & ~a5) ^ (a2 & ~x09)) & ~a3) ^ (a2 & x08) ^ ~x06;
    w[20] = v[20] ^ (x10);
    x11 = (x10 & ~x01) ^ x09;
    x12 = (a6 & ~x11) ^ x06;
    x13 = a2 & ~x12;
    x14 = x11 ^ x13;
    x15 = a5 | a6;
    w[21] = v[21] ^ ((((x15 & ~x01) ^ (x13 | ~a2)) & a3) ^ ~x14);
    x16 = (x03 ^ x06) & ~x08;
    x17 = a5 & (a6 ^ ~x14);
    w[22] = v[22] ^ (((x11 & ~a5) | a3) ^ (a2 & ~x17) ^ ~x16);
    w[23] = v[23] ^ ((((((x15 & x16) ^ x02) & a2) ^ (x12 | x17) ^ ~x05) & a3) ^ (((a5 & x07) | ~a4) & ~a2) ^ (x17 | x02));
}

static inline void s7 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15, x16;

    a1 ^= u[11];
    a2 ^= u[18];
    a3 ^= u[12];
    a4 ^= u[30];
    a5 ^= u[ 7];
    a6 ^= u[23];
    x01 = (a2 & a4) ^ a5;
    x02 = a4 & x01;
    x03 = x02 ^ a2;
    x04 = a3 & ~x03;
    x05 = x01 ^ x04;
    x06 = a3 ^ x04;
    x07 = (a6 & ~x06) ^ x05;
    x08 = x02 ^ x05;
    x09 = (((a2 | a4 | a5) ^ ((a5 & ~a2) | a3) ^ (a6 | x08)) & a1) ^ x07;
    w[24] = v[24] ^ (x09);
    x10 = a4 & ~a3;
    x11 = a2 & a6 & ~x10;
    x12 = a4 ^ x03;
    x13 = (a3 | x02) ^ x12;
    x14 = (a6 & ~((a3 ^ x02) & a2)) ^ x13;
    w[25] = v[25] ^ ((a1 | x14) ^ x07 ^ ~x11);
    x15 = x06 ^ x14;
    w[26] = v[26] ^ ((((a2 | x12) ^ x09) & ~a6) ^ (((x13 & ~a3) | x14) & ~a1) ^ x15);
    x16 = (a2 ^ ~x08) & x12 & a6;
    w[27] = v[27] ^ ((((a3 & x11) ^ x16) | a1) ^ (a5 | x10) ^ x15 ^ x16);
}

static inline void s8 (
    unsigned long a1, unsigned long a2,
    unsigned long a3, unsigned long a4,
    unsigned long a5, unsigned long a6) {

    unsigned long x01, x02, x03, x04, x05, x06, x07, x08;
    unsigned long x09, x10, x11, x12, x13, x14, x15;

    a1 ^= u[ 7];
    a2 ^= u[23];
    a3 ^= u[ 9];
    a4 ^= u[ 1];
    a5 ^= u[24];
    a6 ^= u[15];
    x01 = a3 ^ a1;
    x02 = a1 & ~a3;
    x03 = x02 ^ a4;
    x04 = (a5 | x03) ^ x01;
    x05 = x04 & ~a1;
    x06 = x05 ^ a3;
    x07 = (x06 & ~a5) ^ a4;
    x08 = (a2 & ~x07) ^ x04;
    x09 = (x05 | a4) ^ x01 ^ a5;
    x10 = (x03 & ~x09) ^ x06;
    w[28] = v[28] ^ ((((a2 & ~x10) ^ x09) | a6) ^ ~x08);
    x11 = x04 | a5;
    x12 = x11 ^ x03;
    x13 = x08 & ~a4;
    x14 = (((((a5 & x02) ^ x13) & a2) ^ (a1 & x11)) & ~a6) ^ (a2 & ~x13) ^ x12;
    w[29] = v[29] ^ (x14);
    x15 = x02 & ~x09;
    w[30] = v[30] ^ ((((a3 & ~x10) | x07) ^ (a2 | x05)) ^ ~(((a2 & ~(x12 | x14)) ^ x15) | a6));
    w[31] = v[31] ^ (((((a3 ^ a5 ^ x15) & ~a2) ^ ((x01 & ~a5) | a4)) & a6) ^ ~x08);
}

	switch (init){
	case 0:
		u=PT; v=PT+32; w=t+32+64;
	    s1 (K[47],K[11],K[26],K[ 3],K[13],K[41]) ;
	    s2 (K[27],K[ 6],K[54],K[48],K[39],K[19]) ;
	    s3 (K[53],K[25],K[33],K[34],K[17],K[ 5]) ;
	    s4 (K[ 4],K[55],K[24],K[32],K[40],K[20]) ;
	    s5 (K[36],K[31],K[21],K[ 8],K[23],K[52]) ;
	    s6 (K[14],K[29],K[51],K[ 9],K[35],K[30]) ;
	    s7 (K[ 2],K[37],K[22],K[ 0],K[42],K[38]) ;
	    s8 (K[16],K[43],K[44],K[ 1],K[ 7],K[28]) ;

		u=t+32+64; v=PT; w=t+64;
  		s1 (K[54],K[18],K[33],K[10],K[20],K[48]) ; /* 10, 18 */
  		s2 (K[34],K[13],K[ 4],K[55],K[46],K[26]) ; /* 46 */
  		s3 (K[ 3],K[32],K[40],K[41],K[24],K[12]) ; /* 12 */
  		s4 (K[11],K[ 5],K[ 6],K[39],K[47],K[27]) ;
  		s5 (K[43],K[38],K[28],K[15],K[30],K[ 0]) ; /* 15 */
	    s6 (K[21],K[36],K[31],K[16],K[42],K[37]) ;
	    s7 (K[ 9],K[44],K[29],K[ 7],K[49],K[45]) ; /* 45, 49 */
	    s8 (K[23],K[50],K[51],K[ 8],K[14],K[35]) ; /* 50 */
		break;
	case 1:
		u=t+32+64; v=PT; w=t+64;
  		s1 (K[54],K[18],K[33],K[10],K[20],K[48]) ; /* 10, 18 */
		break;
	case 2:
		u=t+32+64; v=PT; w=t+64;
	    s7 (K[ 9],K[44],K[29],K[ 7],K[49],K[45]) ; /* 45, 49 */
		break;
	case 4:
		u=t+32+64; v=PT; w=t+64;
  		s2 (K[34],K[13],K[ 4],K[55],K[46],K[26]) ; /* 46 */
	default:
	}

	u=t+64; v=t+32+64; w=t+32;
    s1 (K[11],K[32],K[47],K[24],K[34],K[ 5]) ;
    s2 (K[48],K[27],K[18],K[12],K[ 3],K[40]) ;
    s3 (K[17],K[46],K[54],K[55],K[13],K[26]) ;
    s4 (K[25],K[19],K[20],K[53],K[ 4],K[41]) ;
    s5 (K[ 2],K[52],K[42],K[29],K[44],K[14]) ;
    s6 (K[35],K[50],K[45],K[30],K[ 1],K[51]) ;
    s7 (K[23],K[31],K[43],K[21],K[ 8],K[ 0]) ;
    s8 (K[37],K[ 9],K[38],K[22],K[28],K[49]) ;

	u=t+32; v=t+64; w=t;
    s1 (K[25],K[46],K[ 4],K[13],K[48],K[19]) ;
    s2 (K[ 5],K[41],K[32],K[26],K[17],K[54]) ;
    s3 (K[ 6],K[ 3],K[11],K[12],K[27],K[40]) ;
    s4 (K[39],K[33],K[34],K[10],K[18],K[55]) ;
    s5 (K[16],K[ 7],K[ 1],K[43],K[31],K[28]) ;
    s6 (K[49],K[ 9],K[ 0],K[44],K[15],K[38]) ;
    s7 (K[37],K[45],K[ 2],K[35],K[22],K[14]) ;
    s8 (K[51],K[23],K[52],K[36],K[42],K[ 8]) ;

	u=t; v=w=t+32;
    s1 (K[39],K[ 3],K[18],K[27],K[ 5],K[33]) ;
    s2 (K[19],K[55],K[46],K[40],K[ 6],K[11]) ;
    s3 (K[20],K[17],K[25],K[26],K[41],K[54]) ;
    s4 (K[53],K[47],K[48],K[24],K[32],K[12]) ;
    s5 (K[30],K[21],K[15],K[ 2],K[45],K[42]) ;
    s6 (K[ 8],K[23],K[14],K[31],K[29],K[52]) ;
    s7 (K[51],K[ 0],K[16],K[49],K[36],K[28]) ;
    s8 (K[38],K[37],K[ 7],K[50],K[ 1],K[22]) ;

	u=t+32; v=w=t;
    s1 (K[53],K[17],K[32],K[41],K[19],K[47]) ;
    s2 (K[33],K[12],K[ 3],K[54],K[20],K[25]) ;
    s3 (K[34],K[ 6],K[39],K[40],K[55],K[11]) ;
    s4 (K[10],K[ 4],K[ 5],K[13],K[46],K[26]) ;
    s5 (K[44],K[35],K[29],K[16],K[ 0],K[ 1]) ;
    s6 (K[22],K[37],K[28],K[45],K[43],K[ 7]) ;
    s7 (K[38],K[14],K[30],K[ 8],K[50],K[42]) ;
    s8 (K[52],K[51],K[21],K[ 9],K[15],K[36]) ;

	u=t; v=w=t+32;
    s1 (K[10],K[ 6],K[46],K[55],K[33],K[ 4]) ;
    s2 (K[47],K[26],K[17],K[11],K[34],K[39]) ;
    s3 (K[48],K[20],K[53],K[54],K[12],K[25]) ;
    s4 (K[24],K[18],K[19],K[27],K[ 3],K[40]) ;
    s5 (K[31],K[49],K[43],K[30],K[14],K[15]) ;
    s6 (K[36],K[51],K[42],K[ 0],K[ 2],K[21]) ;
    s7 (K[52],K[28],K[44],K[22],K[ 9],K[ 1]) ;
    s8 (K[ 7],K[38],K[35],K[23],K[29],K[50]) ;

	u=t+32; v=w=t;
    s1 (K[24],K[20],K[ 3],K[12],K[47],K[18]) ;
    s2 (K[ 4],K[40],K[ 6],K[25],K[48],K[53]) ;
    s3 (K[ 5],K[34],K[10],K[11],K[26],K[39]) ;
    s4 (K[13],K[32],K[33],K[41],K[17],K[54]) ;
    s5 (K[45],K[ 8],K[ 2],K[44],K[28],K[29]) ;
    s6 (K[50],K[38],K[ 1],K[14],K[16],K[35]) ;
    s7 (K[ 7],K[42],K[31],K[36],K[23],K[15]) ;
    s8 (K[21],K[52],K[49],K[37],K[43],K[ 9]) ;

	u=t; v=w=t+32;
    s1 (K[ 6],K[27],K[10],K[19],K[54],K[25]) ;
    s2 (K[11],K[47],K[13],K[32],K[55],K[ 3]) ;
    s3 (K[12],K[41],K[17],K[18],K[33],K[46]) ;
    s4 (K[20],K[39],K[40],K[48],K[24],K[ 4]) ;
    s5 (K[52],K[15],K[ 9],K[51],K[35],K[36]) ;
    s6 (K[ 2],K[45],K[ 8],K[21],K[23],K[42]) ;
    s7 (K[14],K[49],K[38],K[43],K[30],K[22]) ;
    s8 (K[28],K[ 0],K[ 1],K[44],K[50],K[16]) ;

	u=t+32; v=w=t;
    s1 (K[20],K[41],K[24],K[33],K[11],K[39]) ;
    s2 (K[25],K[ 4],K[27],K[46],K[12],K[17]) ;
    s3 (K[26],K[55],K[ 6],K[32],K[47],K[ 3]) ;
    s4 (K[34],K[53],K[54],K[ 5],K[13],K[18]) ;
    s5 (K[ 7],K[29],K[23],K[38],K[49],K[50]) ;
    s6 (K[16],K[ 0],K[22],K[35],K[37],K[ 1]) ;
    s7 (K[28],K[ 8],K[52],K[ 2],K[44],K[36]) ;
    s8 (K[42],K[14],K[15],K[31],K[ 9],K[30]) ;

	u=t; v=w=t+32;
    s1 (K[34],K[55],K[13],K[47],K[25],K[53]) ;
    s2 (K[39],K[18],K[41],K[ 3],K[26],K[ 6]) ;
    s3 (K[40],K[12],K[20],K[46],K[ 4],K[17]) ;
    s4 (K[48],K[10],K[11],K[19],K[27],K[32]) ;
    s5 (K[21],K[43],K[37],K[52],K[ 8],K[ 9]) ;
    s6 (K[30],K[14],K[36],K[49],K[51],K[15]) ;
    s7 (K[42],K[22],K[ 7],K[16],K[31],K[50]) ;
    s8 (K[ 1],K[28],K[29],K[45],K[23],K[44]) ;

	u=t+32; v=w=t;
    s1 (K[48],K[12],K[27],K[ 4],K[39],K[10]) ;
    s2 (K[53],K[32],K[55],K[17],K[40],K[20]) ;
    s3 (K[54],K[26],K[34],K[ 3],K[18],K[ 6]) ;
    s4 (K[ 5],K[24],K[25],K[33],K[41],K[46]) ;
    s5 (K[35],K[ 2],K[51],K[ 7],K[22],K[23]) ;
    s6 (K[44],K[28],K[50],K[ 8],K[38],K[29]) ;
    s7 (K[ 1],K[36],K[21],K[30],K[45],K[ 9]) ;
    s8 (K[15],K[42],K[43],K[ 0],K[37],K[31]) ;

	u=t; v=w=t+32;
    s1 (K[ 5],K[26],K[41],K[18],K[53],K[24]) ;
    s2 (K[10],K[46],K[12],K[ 6],K[54],K[34]) ;
    s3 (K[11],K[40],K[48],K[17],K[32],K[20]) ;
    s4 (K[19],K[13],K[39],K[47],K[55],K[ 3]) ;
    s5 (K[49],K[16],K[38],K[21],K[36],K[37]) ;
    s6 (K[31],K[42],K[ 9],K[22],K[52],K[43]) ;
    s7 (K[15],K[50],K[35],K[44],K[ 0],K[23]) ;
    s8 (K[29],K[ 1],K[ 2],K[14],K[51],K[45]) ;

	u=t+32; v=w=t;
    s1 (K[19],K[40],K[55],K[32],K[10],K[13]) ;
    s2 (K[24],K[ 3],K[26],K[20],K[11],K[48]) ;
    s3 (K[25],K[54],K[ 5],K[ 6],K[46],K[34]) ;
    s4 (K[33],K[27],K[53],K[ 4],K[12],K[17]) ;
    s5 (K[ 8],K[30],K[52],K[35],K[50],K[51]) ;
    s6 (K[45],K[ 1],K[23],K[36],K[ 7],K[ 2]) ;
    s7 (K[29],K[ 9],K[49],K[31],K[14],K[37]) ;
    s8 (K[43],K[15],K[16],K[28],K[38],K[ 0]) ;

    u=t; v=w=t+32; r=0;
    s1 (K[33],K[54],K[12],K[46],K[24],K[27]) ;
    if ((r |=(CT[ 0]^w[ 0])|(CT[ 1]^w[ 1])|(CT[ 2]^w[ 2])|(CT[ 3]^w[ 3]))==~0UL) return(0);
    s2 (K[13],K[17],K[40],K[34],K[25],K[ 5]) ;
    if ((r |=(CT[ 4]^w[ 4])|(CT[ 5]^w[ 5])|(CT[ 6]^w[ 6])|(CT[ 7]^w[ 7]))==~0UL) return(0);
    s3 (K[39],K[11],K[19],K[20],K[ 3],K[48]) ;
    if ((r |=(CT[ 8]^w[ 8])|(CT[ 9]^w[ 9])|(CT[10]^w[10])|(CT[11]^w[11]))==~0UL) return(0);
    s4 (K[47],K[41],K[10],K[18],K[26],K[ 6]) ;
    if ((r |=(CT[12]^w[12])|(CT[13]^w[13])|(CT[14]^w[14])|(CT[15]^w[15]))==~0UL) return(0);
    s5 (K[22],K[44],K[ 7],K[49],K[ 9],K[38]) ;
    if ((r |=(CT[16]^w[16])|(CT[17]^w[17])|(CT[18]^w[18])|(CT[19]^w[19]))==~0UL) return(0);
    s6 (K[ 0],K[15],K[37],K[50],K[21],K[16]) ;
    if ((r |=(CT[20]^w[20])|(CT[21]^w[21])|(CT[22]^w[22])|(CT[23]^w[23]))==~0UL) return(0);
    s7 (K[43],K[23],K[ 8],K[45],K[28],K[51]) ;
    if ((r |=(CT[24]^w[24])|(CT[25]^w[25])|(CT[26]^w[26])|(CT[27]^w[27]))==~0UL) return(0);
    s8 (K[ 2],K[29],K[30],K[42],K[52],K[14]) ;
    if ((r |=(CT[28]^w[28])|(CT[29]^w[29])|(CT[30]^w[30])|(CT[31]^w[31]))==~0UL) return(0);

    u=t+32; v=w=t;
    s1 (K[40],K[ 4],K[19],K[53],K[ 6],K[34]) ;
    if ((r |=(CT[ 0+32]^w[ 0])|(CT[ 1+32]^w[ 1])|(CT[ 2+32]^w[ 2])|(CT[ 3+32]^w[ 3]))==~0UL) return(0);
    s2 (K[20],K[24],K[47],K[41],K[32],K[12]) ;
    if ((r |=(CT[ 4+32]^w[ 4])|(CT[ 5+32]^w[ 5])|(CT[ 6+32]^w[ 6])|(CT[ 7+32]^w[ 7]))==~0UL) return(0);
    s3 (K[46],K[18],K[26],K[27],K[10],K[55]) ;
    if ((r |=(CT[ 8+32]^w[ 8])|(CT[ 9+32]^w[ 9])|(CT[10+32]^w[10])|(CT[11+32]^w[11]))==~0UL) return(0);
    s4 (K[54],K[48],K[17],K[25],K[33],K[13]) ;
    if ((r |=(CT[12+32]^w[12])|(CT[13+32]^w[13])|(CT[14+32]^w[14])|(CT[15+32]^w[15]))==~0UL) return(0);
    s5 (K[29],K[51],K[14],K[ 1],K[16],K[45]) ;
    if ((r |=(CT[16+32]^w[16])|(CT[17+32]^w[17])|(CT[18+32]^w[18])|(CT[19+32]^w[19]))==~0UL) return(0);
    s6 (K[ 7],K[22],K[44],K[ 2],K[28],K[23]) ;
    if ((r |=(CT[20+32]^w[20])|(CT[21+32]^w[21])|(CT[22+32]^w[22])|(CT[23+32]^w[23]))==~0UL) return(0);
    s7 (K[50],K[30],K[15],K[52],K[35],K[31]) ;
    if ((r |=(CT[24+32]^w[24])|(CT[25+32]^w[25])|(CT[26+32]^w[26])|(CT[27+32]^w[27]))==~0UL) return(0);
    s8 (K[ 9],K[36],K[37],K[49],K[ 0],K[21]) ;
    r |=(CT[28+32]^w[28])|(CT[29+32]^w[29])|(CT[30+32]^w[30])|(CT[31+32]^w[31]);
	return(~r);

}
