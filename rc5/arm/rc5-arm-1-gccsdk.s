	AREA	|C$$code|,CODE,READONLY 
 
        DCB     "@(#)$Id: rc5-arm-1-gccsdk.s,v 1.2 2002/09/02 00:35:55 andreasb Exp $", 0
        ALIGN
	
	EXPORT	|rc5_unit_func_arm_1|

R0	RN	0
R1	RN	1
R2	RN	2
R3	RN	3
R4	RN	4
R5	RN	5
R6	RN	6
R7	RN	7
R8	RN	8
R9	RN	9
R10	RN	10
R11	RN	11
R12	RN	12
R13	RN	13
R14	RN	14
PC	RN	15

pqtable
	DCD	&B7E15163
	DCD	&5618CB1C
	DCD	&F45044D5
	DCD	&9287BE8E
	DCD	&30BF3847
	DCD	&CEF6B200
	DCD	&6D2E2BB9
	DCD	&0B65A572
	DCD	&A99D1F2B
	DCD	&47D498E4
	DCD	&E60C129D
	DCD	&84438C56
	DCD	&227B060F
	DCD	&C0B27FC8
	DCD	&5EE9F981
	DCD	&FD21733A
	DCD	&9B58ECF3
	DCD	&399066AC
	DCD	&D7C7E065
	DCD	&75FF5A1E
	DCD	&1436D3D7
	DCD	&B26E4D90
	DCD	&50A5C749
	DCD	&EEDD4102
	DCD	&8D14BABB
	DCD	&2B4C3474

|rc5_unit_func_arm_1|
	STMDB	R13!,{R4-R12,R14}
	MOV	R14,R1
	LDMIA	R0!,{R4-R7}
	LDMIA	R0,{R2,R3}
	STR	R14,[R13,#-136]!
	STR	R0,[R13,#4]
	ADD	R12,R13,#&20
	STMDB	R13!,{R4-R7}

timingloop
	STR	R3,[R13,#28]
	ADR	R1,pqtable
	LDMIA	R1!,{R4-R10}
	ADD	R3,R3,R4,ROR #29
	MOV	R3,R3,ROR #3
	ADD	R0,R5,R4,ROR #29
	ADD	R5,R0,R3
	ADD	R0,R3,R5,ROR #29
	RSB	R0,R0,#0
	ADD	R6,R6,R5,ROR #29
	STR	R5,[R12,#-16]
	STMDB	R12,{R0,R3,R6}
	B	skippy

timingloop2
	ADR	R1,pqtable+12
	LDMIA	R1!,{R7-R10}
	LDMDB	R12,{R0,R3,R6}

skippy
	ADD	R12,R12,#8
	STR	R2,[R13,#24]
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R6,R6,R2
	ADD	R0,R2,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R7,R6,ROR #29
	ADD	R7,R0,R3
	ADD	R0,R3,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R8,R8,R7,ROR #29
	ADD	R8,R8,R2
	ADD	R0,R2,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R9,R8,ROR #29
	ADD	R9,R0,R3
	ADD	R0,R3,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R10,R10,R9,ROR #29
	ADD	R10,R10,R2
	STMIA	R12!,{R6-R10}
	ADD	R0,R2,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	LDMIA	R1!,{R4-R9,R11}
	ADD	R0,R4,R10,ROR #29
	ADD	R4,R0,R3
	ADD	R0,R3,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R5,R5,R4,ROR #29
	ADD	R5,R5,R2
	ADD	R0,R2,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R6,R5,ROR #29
	ADD	R6,R0,R3
	ADD	R0,R3,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R7,R7,R6,ROR #29
	ADD	R7,R7,R2
	ADD	R0,R2,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R8,R7,ROR #29
	ADD	R8,R0,R3
	ADD	R0,R3,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R9,R9,R8,ROR #29
	ADD	R9,R9,R2
	ADD	R0,R2,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R11,R9,ROR #29
	ADD	R11,R0,R3
	STMIA	R12!,{R4-R9,R11}
	ADD	R0,R3,R11,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	LDMIA	R1!,{R4-R10}
	ADD	R4,R4,R11,ROR #29
	ADD	R4,R4,R2
	ADD	R0,R2,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R5,R4,ROR #29
	ADD	R5,R0,R3
	ADD	R0,R3,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R6,R6,R5,ROR #29
	ADD	R6,R6,R2
	ADD	R0,R2,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R7,R6,ROR #29
	ADD	R7,R0,R3
	ADD	R0,R3,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R8,R8,R7,ROR #29
	ADD	R8,R8,R2
	ADD	R0,R2,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R9,R8,ROR #29
	ADD	R9,R0,R3
	ADD	R0,R3,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R10,R10,R9,ROR #29
	ADD	R10,R10,R2
	STMIA	R12!,{R4-R10}
	ADD	R0,R2,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	LDMIA	R1!,{R4-R8}
	ADD	R0,R4,R10,ROR #29
	ADD	R4,R0,R3
	ADD	R0,R3,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R5,R5,R4,ROR #29
	ADD	R5,R5,R2
	ADD	R0,R2,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R6,R5,ROR #29
	ADD	R6,R0,R3
	ADD	R0,R3,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R7,R7,R6,ROR #29
	ADD	R7,R7,R2
	ADD	R0,R2,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R8,R7,ROR #29
	ADD	R8,R0,R3
	STMIA	R12!,{R4-R8}
	ADD	R0,R3,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	SUB	R12,R12,#&68
	ADD	R0,R2,R8,ROR #29
	LDR	R1,pqtable
	LDR	R4,[R12,#-16]
	ADD	R1,R0,R1,ROR #29
	ADD	R0,R2,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	ADD	R0,R3,R4,ROR #29
	STMIA	R12!,{R1,R4}
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R4,ROR #29
	LDMIA	R12,{R1,R4-R11}
	ADD	R1,R0,R1,ROR #29
	ADD	R0,R2,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	ADD	R0,R3,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	ADD	R0,R2,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R5,ROR #29
	ADD	R6,R0,R6,ROR #29
	ADD	R0,R3,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R6,ROR #29
	ADD	R7,R0,R7,ROR #29
	ADD	R0,R2,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R7,ROR #29
	ADD	R8,R0,R8,ROR #29
	ADD	R0,R3,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R8,ROR #29
	ADD	R9,R0,R9,ROR #29
	ADD	R0,R2,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R9,ROR #29
	ADD	R10,R0,R10,ROR #29
	ADD	R0,R3,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R10,ROR #29
	ADD	R11,R0,R11,ROR #29
	ADD	R0,R2,R11,ROR #29
	STMIA	R12!,{R1,R4-R11}
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R11,ROR #29
	LDMIA	R12,{R1,R4-R11}
	ADD	R1,R0,R1,ROR #29
	ADD	R0,R3,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	ADD	R0,R2,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	ADD	R0,R3,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R5,ROR #29
	ADD	R6,R0,R6,ROR #29
	ADD	R0,R2,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R6,ROR #29
	ADD	R7,R0,R7,ROR #29
	ADD	R0,R3,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R7,ROR #29
	ADD	R8,R0,R8,ROR #29
	ADD	R0,R2,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R8,ROR #29
	ADD	R9,R0,R9,ROR #29
	ADD	R0,R3,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R9,ROR #29
	ADD	R10,R0,R10,ROR #29
	ADD	R0,R2,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R10,ROR #29
	ADD	R11,R0,R11,ROR #29
	ADD	R0,R3,R11,ROR #29
	STMIA	R12!,{R1,R4-R11}
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R11,ROR #29
	LDMIA	R12,{R1,R4-R8}
	ADD	R1,R0,R1,ROR #29
	ADD	R0,R2,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	ADD	R0,R3,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	ADD	R0,R2,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R5,ROR #29
	ADD	R6,R0,R6,ROR #29
	ADD	R0,R3,R6,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R6,ROR #29
	ADD	R7,R0,R7,ROR #29
	ADD	R0,R2,R7,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R7,ROR #29
	ADD	R8,R0,R8,ROR #29
	ADD	R0,R3,R8,ROR #29
	STMIA	R12!,{R1,R4-R8}
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	SUB	R12,R12,#&68
	LDMIA	R13,{R6,R7}
	ADD	R0,R2,R8,ROR #29
	LDMIA	R12!,{R1,R4,R5,R8-R11}
	ADD	R1,R0,R1,ROR #29
	ADD	R7,R7,R1,ROR #29
	ADD	R0,R2,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	ADD	R6,R6,R4,ROR #29
	ADD	R0,R3,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R5,ROR #29
	ADD	R0,R2,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R5,ROR #29
	ADD	R8,R0,R8,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R8,ROR #29
	ADD	R0,R3,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R8,ROR #29
	ADD	R9,R0,R9,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R9,ROR #29
	ADD	R0,R2,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R9,ROR #29
	ADD	R10,R0,R10,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R10,ROR #29
	ADD	R0,R3,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R10,ROR #29
	ADD	R11,R0,R11,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R11,ROR #29
	ADD	R0,R2,R11,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R11,ROR #29
	LDMIA	R12!,{R1,R4,R5,R8-R11}
	ADD	R1,R0,R1,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R1,ROR #29
	ADD	R0,R3,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R4,ROR #29
	ADD	R0,R2,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R5,ROR #29
	ADD	R0,R3,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R5,ROR #29
	ADD	R8,R0,R8,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R8,ROR #29
	ADD	R0,R2,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R8,ROR #29
	ADD	R9,R0,R9,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R9,ROR #29
	ADD	R0,R3,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R9,ROR #29
	ADD	R10,R0,R10,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R10,ROR #29
	ADD	R0,R2,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R10,ROR #29
	ADD	R11,R0,R11,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R11,ROR #29
	ADD	R0,R3,R11,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R11,ROR #29
	LDMIA	R12!,{R1,R4,R5,R8-R11}
	ADD	R1,R0,R1,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R1,ROR #29
	ADD	R0,R2,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R4,ROR #29
	ADD	R0,R3,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R5,ROR #29
	ADD	R0,R2,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R5,ROR #29
	ADD	R8,R0,R8,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R8,ROR #29
	ADD	R0,R3,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R8,ROR #29
	ADD	R9,R0,R9,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R9,ROR #29
	ADD	R0,R2,R9,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R9,ROR #29
	ADD	R10,R0,R10,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R10,ROR #29
	ADD	R0,R3,R10,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R10,ROR #29
	ADD	R11,R0,R11,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R11,ROR #29
	ADD	R0,R2,R11,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R11,ROR #29
	LDMIA	R12!,{R1,R4,R5,R8,R9}
	ADD	R1,R0,R1,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R1,ROR #29
	ADD	R0,R3,R1,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R1,ROR #29
	ADD	R4,R0,R4,ROR #29
	EOR	R7,R7,R6
	RSB	R0,R6,#0
	MOV	R7,R7,ROR R0
	ADD	R7,R7,R4,ROR #29
	ADD	R0,R2,R4,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R4,ROR #29
	ADD	R5,R0,R5,ROR #29
	EOR	R6,R6,R7
	RSB	R0,R7,#0
	MOV	R6,R6,ROR R0
	ADD	R6,R6,R5,ROR #29
	ADD	R0,R3,R5,ROR #29
	RSB	R0,R0,#0
	SUB	R2,R2,R0
	MOV	R2,R2,ROR R0
	ADD	R0,R2,R5,ROR #29
	LDR	R12,[R13,#12]
	ADD	R8,R0,R8,ROR #29
	SUB	R0,R12,R8,ROR #29
	EOR	R0,R6,R0,ROR R6

check_r7
	TEQ	R0,R7
	BEQ	check_r6

missed
	ADD	R12,R13,#&30
	LDR	R2,[R13,#24]
	SUBS	R14,R14,#1
	BEQ	the_end

inc_1st
	ADDS	R2,R2,#&01000000
	BCC	timingloop2

carry_1st
	ADD	R2,R2,#&00010000
	TST	R2,#&00FF0000
	BNE	timingloop2
	SUB	R2,R2,#&01000000
	ADD	R2,R2,#&0100
	TST	R2,#&FF00
	BNE	timingloop2
	SUB	R2,R2,#&00010000
	ADD	R2,R2,#1
	ANDS	R2,R2,#&FF
	BNE	timingloop2
	LDR	R3,[R13,#28]
	ADDS	R3,R3,#&01000000
	BCC	timingloop

carry_1st_again
	ADD	R3,R3,#&00010000
	TST	R3,#&00FF0000
	BNE	timingloop
	SUB	R3,R3,#&01000000
	ADD	R3,R3,#&0100
	TST	R3,#&FF00
	BNE	timingloop
	SUB	R3,R3,#&00010000
	ADD	R3,R3,#1
	AND	R3,R3,#&FF
	B	timingloop

the_end
	ADD	R13,R13,#&10
	LDMIA	R13!,{R0-R3}
	ADDS	R2,R2,#&01000000
	BCC	function_exit
	ADD	R2,R2,#&00010000
	TST	R2,#&00FF0000
	BNE	function_exit
	SUB	R2,R2,#&01000000
	ADD	R2,R2,#&0100
	TST	R2,#&FF00
	BNE	function_exit
	SUB	R2,R2,#&00010000
	ADD	R2,R2,#1
	ANDS	R2,R2,#&FF
	BNE	function_exit
	ADDS	R3,R3,#&01000000
	BCC	function_exit
	ADD	R3,R3,#&00010000
	TST	R3,#&00FF0000
	BNE	function_exit
	SUB	R3,R3,#&01000000
	ADD	R3,R3,#&0100
	TST	R3,#&FF00
	BNE	function_exit
	SUB	R3,R3,#&00010000
	ADD	R3,R3,#1
	AND	R3,R3,#&FF

function_exit
	SUB	R0,R0,R14
	STMIA	R1,{R2,R3}
	ADD	R13,R13,#&78
	LDMIA	R13!,{R4-R12,PC}^

check_r6
	ADD	R0,R2,R8,ROR #29
	RSB	R0,R0,#0
	SUB	R3,R3,R0
	MOV	R3,R3,ROR R0
	ADD	R0,R3,R8,ROR #29
	LDR	R8,[R13,#148]
	ADD	R0,R0,R8,ROR #29
	MOV	R8,R0,ROR #29
	LDR	R0,[R13,#8]
	SUB	R0,R0,R8
	EOR	R0,R12,R0,ROR R12
	TEQ	R0,R6
	BNE	missed
	ADD	R13,R13,#&10
	LDMIA	R13!,{R0-R3}
	B	function_exit
